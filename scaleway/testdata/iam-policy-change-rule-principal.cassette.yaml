---
version: 1
interactions:
- request:
    body: '{"name":"tf_tests_policy_changeruleprincipal","description":"a description","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf","rules":[{"permission_set_names":["AllProductsFullAccess"],"project_ids":null,"organization_id":"105bdce1-64c0-48ab-899d-868455867ecf"}],"no_principal":true}'
    form: {}
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/policies
    method: POST
  response:
    body: '{"message":"grpc: error while marshaling: proto: oneof field has nil value"}'
    headers:
      Content-Length:
      - "76"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:46 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - 94947208-be7f-4dba-8d8b-e79065e50fcc
    status: 500 Internal Server Error
    code: 500
    duration: ""
- request:
    body: '{"name":"tf_tests_policy_changeruleprincipal","description":"a description","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf","rules":[{"permission_set_names":["AllProductsFullAccess"],"project_ids":null,"organization_id":"105bdce1-64c0-48ab-899d-868455867ecf"}],"no_principal":true}'
    form: {}
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/policies
    method: POST
  response:
    body: '{"id":"8950ca30-6e9e-4a9f-b3a9-b8cf88febad6","name":"tf_tests_policy_changeruleprincipal","description":"a
      description","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf","created_at":"2022-07-06T13:33:48.529Z","updated_at":"2022-07-06T13:33:48.529Z","editable":true,"nb_rules":1,"nb_scopes":1,"nb_permission_sets":1,"no_principal":true}'
    headers:
      Content-Length:
      - "343"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:48 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - aa66d0ee-be6e-4a2d-918f-c538f121a9c5
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/policies/8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"id":"8950ca30-6e9e-4a9f-b3a9-b8cf88febad6","name":"tf_tests_policy_changeruleprincipal","description":"a
      description","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf","created_at":"2022-07-06T13:33:48.529Z","updated_at":"2022-07-06T13:33:48.529Z","editable":true,"nb_rules":1,"nb_scopes":1,"nb_permission_sets":1,"no_principal":true}'
    headers:
      Content-Length:
      - "343"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:48 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - 2cd92875-d9b1-4deb-b1e1-6faade9c5e8f
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/rules?policy_id=8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"rules":[{"id":"1332d19e-4205-4244-bbae-8ffd9bd20638","permission_set_names":["AllProductsFullAccess"],"permission_sets_scope_type":"organization","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf"}],"total_count":1}'
    headers:
      Content-Length:
      - "223"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:48 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - 1c53f01b-67e8-4cf5-94c2-396c3b477c13
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/policies/8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"id":"8950ca30-6e9e-4a9f-b3a9-b8cf88febad6","name":"tf_tests_policy_changeruleprincipal","description":"a
      description","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf","created_at":"2022-07-06T13:33:48.529Z","updated_at":"2022-07-06T13:33:48.529Z","editable":true,"nb_rules":1,"nb_scopes":1,"nb_permission_sets":1,"no_principal":true}'
    headers:
      Content-Length:
      - "343"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:48 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - 81f9059a-e292-436a-bafc-7b088602b442
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/policies/8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"id":"8950ca30-6e9e-4a9f-b3a9-b8cf88febad6","name":"tf_tests_policy_changeruleprincipal","description":"a
      description","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf","created_at":"2022-07-06T13:33:48.529Z","updated_at":"2022-07-06T13:33:48.529Z","editable":true,"nb_rules":1,"nb_scopes":1,"nb_permission_sets":1,"no_principal":true}'
    headers:
      Content-Length:
      - "343"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:49 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - f2e754b8-27a6-4fc6-9bd1-4d73bd6d9599
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/rules?policy_id=8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"rules":[{"id":"1332d19e-4205-4244-bbae-8ffd9bd20638","permission_set_names":["AllProductsFullAccess"],"permission_sets_scope_type":"organization","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf"}],"total_count":1}'
    headers:
      Content-Length:
      - "223"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:49 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - 2680f149-d787-4fa0-bdbb-6448c5dae021
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/policies/8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"id":"8950ca30-6e9e-4a9f-b3a9-b8cf88febad6","name":"tf_tests_policy_changeruleprincipal","description":"a
      description","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf","created_at":"2022-07-06T13:33:48.529Z","updated_at":"2022-07-06T13:33:48.529Z","editable":true,"nb_rules":1,"nb_scopes":1,"nb_permission_sets":1,"no_principal":true}'
    headers:
      Content-Length:
      - "343"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:49 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - 9566959f-85ca-4aa7-aef0-b3cdce892f3b
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/rules?policy_id=8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"rules":[{"id":"1332d19e-4205-4244-bbae-8ffd9bd20638","permission_set_names":["AllProductsFullAccess"],"permission_sets_scope_type":"organization","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf"}],"total_count":1}'
    headers:
      Content-Length:
      - "223"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:49 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - 02bd2b44-8510-4d64-8931-eb2289dd4efd
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: '{"policy_id":"8950ca30-6e9e-4a9f-b3a9-b8cf88febad6","rules":[{"permission_set_names":["AllProductsFullAccess"],"project_ids":["105bdce1-64c0-48ab-899d-868455867ecf"]}]}'
    form: {}
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/rules
    method: PUT
  response:
    body: '{"rules":[{"id":"9248bbff-7f20-49cb-b4f5-ecfc696cba9c","permission_set_names":["AllProductsFullAccess"],"permission_sets_scope_type":"projects","project_ids":["105bdce1-64c0-48ab-899d-868455867ecf"]}]}'
    headers:
      Content-Length:
      - "201"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:50 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - 218161e2-036e-4cec-a1d3-8efac61139f1
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/policies/8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"id":"8950ca30-6e9e-4a9f-b3a9-b8cf88febad6","name":"tf_tests_policy_changeruleprincipal","description":"a
      description","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf","created_at":"2022-07-06T13:33:48.529Z","updated_at":"2022-07-06T13:33:48.529Z","editable":true,"nb_rules":1,"nb_scopes":1,"nb_permission_sets":1,"no_principal":true}'
    headers:
      Content-Length:
      - "343"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:50 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - d69a53ec-1b0f-4313-af4f-0b1a899d41c8
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/rules?policy_id=8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"rules":[{"id":"9248bbff-7f20-49cb-b4f5-ecfc696cba9c","permission_set_names":["AllProductsFullAccess"],"permission_sets_scope_type":"projects","project_ids":["105bdce1-64c0-48ab-899d-868455867ecf"]}],"total_count":1}'
    headers:
      Content-Length:
      - "217"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:50 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - 45d3f47f-e893-4775-96ab-efa41a97c4ba
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/policies/8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"id":"8950ca30-6e9e-4a9f-b3a9-b8cf88febad6","name":"tf_tests_policy_changeruleprincipal","description":"a
      description","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf","created_at":"2022-07-06T13:33:48.529Z","updated_at":"2022-07-06T13:33:48.529Z","editable":true,"nb_rules":1,"nb_scopes":1,"nb_permission_sets":1,"no_principal":true}'
    headers:
      Content-Length:
      - "343"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:50 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - 389d7977-b920-469a-8495-6ace9e31b985
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/policies/8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"id":"8950ca30-6e9e-4a9f-b3a9-b8cf88febad6","name":"tf_tests_policy_changeruleprincipal","description":"a
      description","organization_id":"105bdce1-64c0-48ab-899d-868455867ecf","created_at":"2022-07-06T13:33:48.529Z","updated_at":"2022-07-06T13:33:48.529Z","editable":true,"nb_rules":1,"nb_scopes":1,"nb_permission_sets":1,"no_principal":true}'
    headers:
      Content-Length:
      - "343"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:50 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - fa46eb81-45f8-4e8a-b6a5-d2c00cf1b025
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/rules?policy_id=8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"rules":[{"id":"9248bbff-7f20-49cb-b4f5-ecfc696cba9c","permission_set_names":["AllProductsFullAccess"],"permission_sets_scope_type":"projects","project_ids":["105bdce1-64c0-48ab-899d-868455867ecf"]}],"total_count":1}'
    headers:
      Content-Length:
      - "217"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:50 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - 05942c8f-7eb8-4541-86a3-204b1f0177df
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/policies/8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: DELETE
  response:
    body: ""
    headers:
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:51 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - 9a8a5500-fedc-46ed-aa1e-4ddbe93f073f
    status: 204 No Content
    code: 204
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      User-Agent:
      - scaleway-sdk-go/v1.0.0-beta.7+dev (go1.18.2; linux; amd64) terraform-provider/develop
        terraform/terraform-tests
    url: https://api.scaleway.com/iam/v1alpha1/policies/8950ca30-6e9e-4a9f-b3a9-b8cf88febad6
    method: GET
  response:
    body: '{"message":"resource is not found","resource":"policy","resource_id":"8950ca30-6e9e-4a9f-b3a9-b8cf88febad6","type":"not_found"}'
    headers:
      Content-Length:
      - "127"
      Content-Security-Policy:
      - default-src 'none'; frame-ancestors 'none'
      Content-Type:
      - application/json
      Date:
      - Wed, 06 Jul 2022 13:33:51 GMT
      Server:
      - Scaleway API-Gateway
      Strict-Transport-Security:
      - max-age=63072000
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - DENY
      X-Request-Id:
      - b0355b10-3e16-4dd5-9efb-8648f9bded0e
    status: 404 Not Found
    code: 404
    duration: ""
